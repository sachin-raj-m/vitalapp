module.exports=[73922,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(78560),e=a.i(53131);let f=(0,c.createContext)(void 0);function g({children:a}){let{user:g}=(0,e.useAuth)(),[h,i]=(0,c.useState)([]),[j,k]=(0,c.useState)(new Set),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)(null),p=(0,c.useCallback)(async()=>{try{m(!0),o(null);let{data:a,error:b}=await d.supabase.from("blood_requests").select("*").eq("status","active").order("created_at",{ascending:!1});if(b)throw b;if(i(a||[]),g){let{data:a,error:b}=await d.supabase.from("donations").select("request_id").eq("donor_id",g.id).neq("status","cancelled");!b&&a&&k(new Set(a.map(a=>a.request_id)))}else k(new Set)}catch(a){console.error("Error in RequestsContext:",a),o(a)}finally{m(!1)}},[g]);return(0,c.useEffect)(()=>{p();let a=d.supabase.channel("public_requests").on("postgres_changes",{event:"*",schema:"public",table:"blood_requests"},()=>{p()}).subscribe();return()=>{d.supabase.removeChannel(a)}},[p,g]),(0,b.jsx)(f.Provider,{value:{requests:h,myDonations:j,loading:l,error:n,refreshRequests:p},children:a})}a.s(["RequestsProvider",()=>g,"useRequests",0,()=>{let a=(0,c.useContext)(f);if(void 0===a)throw Error("useRequests must be used within a RequestsProvider");return a}])},25775,a=>{"use strict";var b=a.i(87924),c=a.i(73922);function d({children:a}){return(0,b.jsx)(c.RequestsProvider,{children:a})}a.s(["default",()=>d])}];

//# sourceMappingURL=_dcbbdde7._.js.map