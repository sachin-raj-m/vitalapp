module.exports=[34904,a=>{"use strict";var b=a.i(87924);a.s(["Card",0,({children:a,className:c=""})=>(0,b.jsx)("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${c}`,children:a}),"CardBody",0,({children:a,className:c=""})=>(0,b.jsx)("div",{className:`px-6 py-4 ${c}`,children:a}),"CardHeader",0,({children:a,className:c=""})=>(0,b.jsx)("div",{className:`px-6 py-4 border-b border-gray-200 ${c}`,children:a})])},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},24987,a=>{"use strict";let b=(0,a.i(70106).default)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},54300,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(24987),f=a.i(90821),g=a.i(34904),h=a.i(18180),i=a.i(12466),j=a.i(24452),k=a.i(53131),l=a.i(78560);let m=(0,a.i(19721).default)(async()=>{},{loadableGenerated:{modules:[5481]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"h-[400px] w-full bg-gray-100 animate-pulse flex items-center justify-center rounded-lg",children:(0,b.jsx)("span",{className:"text-gray-400",children:"Loading Map..."})})});function n(){let a=(0,d.useRouter)(),{user:n,loading:o}=(0,k.useAuth)(),[p,q]=(0,c.useState)(!1),[r,s]=(0,c.useState)("");if(o)return(0,b.jsx)("div",{className:"flex justify-center items-center min-h-[50vh]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});if(!n)return a.push("/login?redirect=/requests/new"),(0,b.jsx)("div",{className:"flex justify-center items-center min-h-[50vh]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})});let[t,u]=(0,c.useState)({bloodGroup:"",unitsNeeded:1,dateNeeded:"",hospitalName:"",hospitalAddress:"",urgencyLevel:"",notes:"",contactName:n?.full_name||"",contactPhone:n?.phone||"",location:{latitude:0,longitude:0,address:""},city:"",zipcode:""}),v=async b=>{if(b.preventDefault(),n){q(!0),s("");try{let{data:b,error:c}=await l.supabase.from("blood_requests").insert({user_id:n.id,blood_group:t.bloodGroup,units_needed:t.unitsNeeded,date_needed:t.dateNeeded,hospital_name:t.hospitalName,hospital_address:t.hospitalAddress,urgency_level:t.urgencyLevel,notes:t.notes,contact_name:t.contactName,contact_phone:t.contactPhone,location:t.location,city:t.city,zipcode:t.zipcode,status:"active"}).select();if(c)throw c;fetch("/api/notify/donors",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({requestId:b?.[0]?.id,bloodGroup:t.bloodGroup,hospitalName:t.hospitalName,city:t.city,urgencyLevel:t.urgencyLevel})}).catch(a=>console.error("Notification trigger failed",a)),a.push("/requests")}catch(a){s(a.message||"Failed to create request")}finally{q(!1)}}};return(0,b.jsx)("div",{className:"max-w-2xl mx-auto",children:(0,b.jsxs)(g.Card,{children:[(0,b.jsxs)(g.CardHeader,{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Blood Request"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Fill in the details to create a new blood request"})]}),(0,b.jsxs)(g.CardBody,{children:[r&&(0,b.jsx)(j.Alert,{variant:"error",className:"mb-4",children:r}),(0,b.jsxs)("form",{onSubmit:v,className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsx)(h.Select,{label:"Blood Group",value:t.bloodGroup,onChange:a=>u({...t,bloodGroup:a.target.value}),options:[{value:"",label:"Select Blood Group"},{value:"A+",label:"A+"},{value:"A-",label:"A-"},{value:"B+",label:"B+"},{value:"B-",label:"B-"},{value:"AB+",label:"AB+"},{value:"AB-",label:"AB-"},{value:"O+",label:"O+"},{value:"O-",label:"O-"}],required:!0}),(0,b.jsx)(h.Input,{type:"number",label:"Units Needed",min:1,value:t.unitsNeeded,onChange:a=>u({...t,unitsNeeded:parseInt(a.target.value)}),required:!0}),(0,b.jsx)(h.Input,{type:"date",label:"Date Needed",value:t.dateNeeded,min:new Date().toISOString().split("T")[0],onChange:a=>u({...t,dateNeeded:a.target.value}),required:!0})]}),(0,b.jsx)(h.Input,{label:"Hospital Name",value:t.hospitalName,onChange:a=>u({...t,hospitalName:a.target.value}),required:!0}),(0,b.jsx)(h.Input,{label:"Hospital Address",value:t.hospitalAddress,onChange:a=>u({...t,hospitalAddress:a.target.value}),required:!0}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsx)(h.Input,{label:"City",value:t.city,onChange:a=>u({...t,city:a.target.value}),required:!0,placeholder:"e.g. Bangalore"}),(0,b.jsx)(h.Input,{label:"Zip Code",value:t.zipcode,onChange:a=>u({...t,zipcode:a.target.value}),required:!0,placeholder:"e.g. 560001"})]}),(0,b.jsx)(h.Select,{label:"Urgency Level",value:t.urgencyLevel,onChange:a=>u({...t,urgencyLevel:a.target.value}),options:[{value:"",label:"Select Urgency Level"},{value:"High",label:"High"},{value:"Medium",label:"Medium"},{value:"Low",label:"Low"}],required:!0}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Location Selection (Click on map)"}),(0,b.jsx)("div",{className:"h-[400px] border border-gray-300 rounded-lg overflow-hidden relative z-0",children:(0,b.jsx)(m,{interactive:!0,center:{lat:20.5937,lng:78.9629},zoom:5,selectedPosition:t.location.latitude?{lat:t.location.latitude,lng:t.location.longitude}:null,markers:[],onLocationSelect:a=>{u(b=>({...b,location:{...b.location,latitude:a.lat,longitude:a.lng}}))}})}),(0,b.jsxs)("div",{className:"flex gap-2 mt-2",children:[(0,b.jsx)(i.Button,{type:"button",variant:"secondary",onClick:()=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(a=>{u(b=>({...b,location:{...b.location,latitude:a.coords.latitude,longitude:a.coords.longitude}}))},a=>{console.error("Error getting location")})},leftIcon:(0,b.jsx)(e.MapPin,{className:"h-5 w-5"}),children:"Use My Current Location"}),0!==t.location.latitude&&(0,b.jsxs)("span",{className:"text-sm text-green-600 flex items-center",children:[(0,b.jsx)(e.MapPin,{className:"h-4 w-4 mr-1"}),"Lat: ",t.location.latitude.toFixed(4),", Lng: ",t.location.longitude.toFixed(4)]})]})]}),(0,b.jsxs)("div",{className:"grid md:grid-cols-2 gap-4",children:[(0,b.jsx)(h.Input,{label:"Contact Name",value:t.contactName,onChange:a=>u({...t,contactName:a.target.value}),required:!0}),(0,b.jsx)(h.Input,{label:"Contact Phone",value:t.contactPhone,onChange:a=>u({...t,contactPhone:a.target.value}),required:!0})]}),(0,b.jsx)(h.Textarea,{label:"Additional Notes",value:t.notes,onChange:a=>u({...t,notes:a.target.value}),placeholder:"Any additional information that might be helpful..."}),(0,b.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,b.jsx)(i.Button,{type:"button",variant:"ghost",onClick:()=>a.push("/requests"),children:"Cancel"}),(0,b.jsx)(i.Button,{type:"submit",variant:"primary",isLoading:p,leftIcon:(0,b.jsx)(f.AlertCircle,{className:"h-5 w-5"}),children:"Create Request"})]})]})]})]})})}a.s(["default",()=>n])}];

//# sourceMappingURL=_2446313f._.js.map