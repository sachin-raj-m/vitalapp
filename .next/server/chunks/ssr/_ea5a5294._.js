module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},95756,a=>{"use strict";let b=(0,a.i(70106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],95756)},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},24987,a=>{"use strict";let b=(0,a.i(70106).default)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},3314,a=>{"use strict";let b=(0,a.i(70106).default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);a.s(["Shield",()=>b],3314)},41675,a=>{"use strict";let b=(0,a.i(70106).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},93518,a=>{"use strict";let b=(0,a.i(70106).default)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]);a.s(["Award",()=>b],93518)},41710,a=>{"use strict";let b=(0,a.i(70106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],41710)},90669,a=>{"use strict";let b=(0,a.i(70106).default)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);a.s(["Activity",()=>b],90669)},76472,a=>{"use strict";let b=(0,a.i(70106).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],76472)},64245,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(50944),f=a.i(90669),g=a.i(41675),h=a.i(76472),i=a.i(3314),j=a.i(93518),k=a.i(95756),l=a.i(34904),m=a.i(12466),n=a.i(24445),o=a.i(53131),p=a.i(78560),q=a.i(25551),r=a.i(58419),s=a.i(5483),t=a.i(12055);function u(a){let b=(0,r.toDate)(a);return b.setHours(0,0,0,0),b}var v=a.i(8668);function w(a,b){let c=a.getFullYear()-b.getFullYear()||a.getMonth()-b.getMonth()||a.getDate()-b.getDate()||a.getHours()-b.getHours()||a.getMinutes()-b.getMinutes()||a.getSeconds()-b.getSeconds()||a.getMilliseconds()-b.getMilliseconds();return c<0?-1:c>0?1:c}function x(){var a;let{user:x}=(0,o.useAuth)(),y=(0,e.useRouter)(),[z,A]=(0,c.useState)({activeRequests:0,completedDonations:0,livesImpacted:0}),[B,C]=(0,c.useState)([]),[D,E]=(0,c.useState)(null),[F,G]=(0,c.useState)(!0);(0,c.useEffect)(()=>{x&&H()},[x]);let H=async()=>{if(x)try{G(!0);let{data:a}=await p.supabase.from("blood_requests").select("*").eq("status","active").order("created_at",{ascending:!1}),{data:b}=await p.supabase.from("donations").select("*").eq("donor_id",x.id).eq("status","completed").order("created_at",{ascending:!1}),c=b?.length||0,d=b?.[0]?new Date(b[0].created_at):null;if(A({activeRequests:a?.length||0,completedDonations:c,livesImpacted:3*c}),E(d),a&&x.blood_group){let b=a.filter(a=>a.user_id!==x.id&&!!x.blood_group&&!!a.blood_group&&(0,q.isBloodCompatible)(x.blood_group,a.blood_group));C(b)}}catch(a){console.error("Error fetching dashboard data",a)}finally{G(!1)}},I=(a=z.completedDonations)>=10?{name:"Gold Donor",color:"text-yellow-600 bg-yellow-100",icon:i.Shield}:a>=5?{name:"Silver Donor",color:"text-gray-600 bg-gray-100",icon:i.Shield}:a>=1?{name:"Bronze Donor",color:"text-orange-700 bg-orange-100",icon:j.Award}:{name:"New Donor",color:"text-blue-600 bg-blue-100",icon:h.Heart},J=I.icon,K=(()=>{let a;if(!D)return{isReady:!0,message:"You are ready to donate today!"};let b=(a=(0,r.toDate)(D),isNaN(56)?(0,s.constructFrom)(D,NaN):(a.setDate(a.getDate()+56),a)),c=new Date;if(c>=b)return{isReady:!0,message:"You are ready to donate again!"};{let a,d,e,f,g,h,i,j,k=(a=(0,r.toDate)(b),e=w(a,d=(0,r.toDate)(c)),h=Math.abs((f=u(a),g=u(d),Math.round((f-(0,v.getTimezoneOffsetInMilliseconds)(f)-(g-(0,v.getTimezoneOffsetInMilliseconds)(g)))/t.millisecondsInDay))),a.setDate(a.getDate()-e*h),i=Number(w(a,d)===-e),0==(j=e*(h-i))?0:j);return{isReady:!1,message:`Eligible in ${k} days`,nextDate:b}}})();return F?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-[60vh]",children:(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500"})}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Dashboard"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Overview of your impact and matches"})]}),(0,b.jsxs)("div",{className:`flex items-center space-x-2 px-4 py-2 rounded-full ${I.color}`,children:[(0,b.jsx)(J,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"font-semibold",children:I.name})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsx)(l.Card,{className:K.isReady?"border-l-4 border-l-success-500":"border-l-4 border-l-orange-500",children:(0,b.jsxs)(l.CardBody,{className:"flex flex-col h-full justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-700",children:"Donation Status"}),(0,b.jsx)(g.Calendar,{className:K.isReady?"text-success-500":"text-orange-500"})]}),(0,b.jsx)("p",{className:`text-xl font-bold ${K.isReady?"text-success-600":"text-orange-600"}`,children:K.isReady?"Ready to Donate":"Recovery Period"}),(0,b.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:K.message})]}),K.isReady&&(0,b.jsx)(d.default,{href:"/requests",className:"mt-4",children:(0,b.jsx)(m.Button,{size:"sm",variant:"outline",className:"w-full text-success-600 border-success-200 hover:bg-success-50",children:"Find a Match"})})]})}),(0,b.jsx)(l.Card,{children:(0,b.jsxs)(l.CardBody,{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h3",{className:"font-semibold text-gray-700",children:"Your Impact"}),(0,b.jsx)(f.Activity,{className:"text-primary-500"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-3xl font-bold text-gray-900",children:z.livesImpacted}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Estimated lives saved"})]}),(0,b.jsxs)("div",{className:"pt-4 border-t border-gray-100 flex justify-between text-sm",children:[(0,b.jsx)("span",{className:"text-gray-600",children:"Donations made"}),(0,b.jsx)("span",{className:"font-medium",children:z.completedDonations})]})]})]})}),(0,b.jsx)(l.Card,{className:"bg-gradient-to-br from-primary-600 to-primary-700 text-white",children:(0,b.jsxs)(l.CardBody,{className:"flex flex-col h-full justify-between text-white",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-primary-100 mb-2",children:"Community Needs"}),(0,b.jsxs)("p",{className:"text-2xl font-bold mb-1",children:[z.activeRequests," Active Requests"]}),(0,b.jsx)("p",{className:"text-sm text-primary-100 opacity-90",children:B.length>0?(0,b.jsxs)("span",{className:"font-bold bg-white/20 px-2 py-0.5 rounded text-white",children:[B.length," Matches For You"]}):"No compatible requests right now"})]}),(0,b.jsx)(d.default,{href:"/requests/new",className:"mt-4",children:(0,b.jsx)(m.Button,{variant:"secondary",className:"w-full bg-white text-primary-700 hover:bg-gray-100 border-0",children:"Request Blood"})})]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex justify-between items-center",children:[(0,b.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center",children:[(0,b.jsx)(h.Heart,{className:"h-5 w-5 mr-2 text-primary-500"}),"Recommended for You"]}),(0,b.jsx)(d.default,{href:"/requests",className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"See All Requests"})]}),B.length>0?(0,b.jsx)("div",{className:"space-y-4",children:B.map(a=>(0,b.jsx)(n.BloodRequestCard,{request:a,onRespond:()=>y.push("/requests"),userBloodGroup:x?.blood_group,isOwnRequest:a.user_id===x?.id},a.id))}):(0,b.jsx)(l.Card,{className:"bg-gray-50 border-dashed",children:(0,b.jsxs)(l.CardBody,{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"mx-auto w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mb-3",children:(0,b.jsx)(k.CheckCircle,{className:"h-6 w-6 text-gray-400"})}),(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"All Good!"}),(0,b.jsxs)("p",{className:"text-gray-500 max-w-sm mx-auto",children:["There are no urgent requests matching your blood group (",x?.blood_group,") right now."]}),(0,b.jsx)(d.default,{href:"/requests",className:"mt-4 inline-block",children:(0,b.jsx)(m.Button,{variant:"outline",children:"Browse All Requests"})})]})})]})]})}a.s(["default",()=>x],64245)}];

//# sourceMappingURL=_ea5a5294._.js.map