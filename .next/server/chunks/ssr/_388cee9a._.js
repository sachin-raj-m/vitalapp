module.exports=[33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},76472,a=>{"use strict";let b=(0,a.i(70106).default)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);a.s(["Heart",()=>b],76472)},41675,a=>{"use strict";let b=(0,a.i(70106).default)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);a.s(["Calendar",()=>b],41675)},92994,a=>{"use strict";var b=a.i(87924),c=a.i(12466);a.s(["EmptyState",0,({icon:a,title:d,description:e,actionLabel:f,onAction:g,className:h})=>(0,b.jsxs)("div",{className:`flex flex-col items-center justify-center py-12 px-4 text-center bg-white rounded-lg border border-gray-100 shadow-sm ${h||""}`,children:[(0,b.jsx)("div",{className:"bg-primary-50 p-4 rounded-full mb-4",children:(0,b.jsx)(a,{className:"h-8 w-8 text-primary-500"})}),(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:d}),(0,b.jsx)("p",{className:"text-gray-500 text-sm max-w-sm mb-6 leading-relaxed",children:e}),f&&g&&(0,b.jsx)(c.Button,{onClick:g,variant:"primary",children:f})]})])},62104,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(34904),e=a.i(34048),f=a.i(53131),g=a.i(73922),h=a.i(78560),i=a.i(26017),j=a.i(41675),k=a.i(76472),l=a.i(12466),m=a.i(24452),n=a.i(92994);function o(){let{user:a}=(0,f.useAuth)(),{refreshRequests:o}=(0,g.useRequests)(),[p,q]=(0,c.useState)([]),[r,s]=(0,c.useState)(!0),[t,u]=(0,c.useState)(""),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)("all");(0,c.useEffect)(()=>{(async()=>{if(a)try{let{data:b,error:c}=await h.supabase.from("donations").select(`
                        id,
                        created_at,
                        status,
                        request:blood_requests (
                            hospital_name,
                            status
                        )
                    `).eq("donor_id",a.id).order("created_at",{ascending:!1});if(c)throw c;let d=(b||[]).map(a=>({...a,request:Array.isArray(a.request)?a.request[0]:a.request}));q(d)}catch(a){console.error("Error fetching donations"),u("Failed to load donation history")}finally{s(!1)}})()},[a]);let z=async a=>{if(confirm("Are you sure you want to withdraw this donation offer?")){w(a);try{let{error:b}=await h.supabase.from("donations").update({status:"cancelled"}).eq("id",a);if(b)throw b;q(b=>b.map(b=>b.id===a?{...b,status:"cancelled"}:b)),await o()}catch(a){console.error("Error withdrawing donation",a),u("Failed to withdraw donation")}finally{w(null)}}},A=a=>"completed"===a.status?{label:"Verified",variant:"success"}:"cancelled"===a.status?{label:"Withdrawn",variant:"neutral"}:a.request?.status==="fulfilled"||a.request?.status==="closed"?{label:"Request Fulfilled",variant:"neutral"}:{label:"Pending",variant:"warning"},B=p.filter(a=>"completed"===a.status),C=B.length,D=(()=>{let a=0===B.length?null:new Date(B[0].created_at);if(!a)return new Date;let b=new Date(a);return b.setDate(b.getDate()+56),b})(),E=D<=new Date,F=p.filter(a=>{let b=A(a).label;return"all"===x||("pending"===x?"Pending"===b:"verified"===x?"Verified"===b:"closed"!==x||"Request Fulfilled"===b||"Withdrawn"===b)});return r?(0,b.jsx)("div",{className:"flex justify-center items-center min-h-[60vh]",children:(0,b.jsx)(i.Loader2,{className:"h-8 w-8 animate-spin text-primary-500"})}):(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"My Donations"}),t&&(0,b.jsx)(m.Alert,{variant:"error",className:"mb-4",children:t}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Total Donations"})}),(0,b.jsxs)(d.CardBody,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-primary-500",children:C}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Lives impacted"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Points Earned"})}),(0,b.jsxs)(d.CardBody,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold text-secondary-500",children:50*C}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Reward points"})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsx)(d.CardHeader,{children:(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Next Available"})}),(0,b.jsxs)(d.CardBody,{children:[(0,b.jsx)("div",{className:`text-3xl font-bold ${E?"text-success-500":"text-orange-500"}`,children:E?"Ready":D.toLocaleDateString()}),(0,b.jsx)("p",{className:"text-sm text-gray-500",children:E?"You can donate again":"Next eligible date"})]})]})]}),(0,b.jsxs)(d.Card,{children:[(0,b.jsxs)(d.CardHeader,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[(0,b.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Donation History"}),(0,b.jsx)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:["all","pending","verified","closed"].map(a=>(0,b.jsx)("button",{onClick:()=>y(a),className:`px-4 py-1.5 rounded-md text-sm font-medium transition-all ${x===a?"bg-white text-gray-900 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]}),(0,b.jsx)(d.CardBody,{children:0===F.length?(0,b.jsx)(n.EmptyState,{icon:k.Heart,title:"all"===x?"No donations found":`No ${x} donations`,description:"all"===x?"Your journey starts here. Find a request to help.":"Try changing the filter.",actionLabel:"all"===x?"Find Requests":void 0,className:"bg-white border-none shadow-none py-8",onAction:()=>window.location.href="/requests"}):(0,b.jsx)("div",{className:"space-y-4",children:F.map(a=>{let c=A(a);return(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 border-b last:border-0 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:a.request?.hospital_name||"Unknown Hospital"}),(0,b.jsxs)("p",{className:"text-sm text-gray-500 flex items-center mt-1",children:[(0,b.jsx)(j.Calendar,{className:"h-3 w-3 mr-1"}),new Date(a.created_at).toLocaleDateString()]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 w-full sm:w-auto justify-between sm:justify-start",children:[(0,b.jsx)(e.Badge,{variant:c.variant,children:c.label}),"Request Fulfilled"===c.label&&(0,b.jsx)("span",{className:"text-xs text-gray-500 hidden sm:inline-block",children:"Donated by someone else"}),"Pending"===c.label&&(0,b.jsx)(l.Button,{variant:"outline",size:"sm",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:()=>z(a.id),isLoading:v===a.id,children:"Withdraw"})]})]},a.id)})})})]})]})}a.s(["default",()=>o])}];

//# sourceMappingURL=_388cee9a._.js.map