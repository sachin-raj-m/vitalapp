module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},95756,a=>{"use strict";let b=(0,a.i(70106).default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>b],95756)},24452,90821,a=>{"use strict";var b=a.i(87924),c=a.i(70106);let d=(0,c.default)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);a.s(["AlertCircle",()=>d],90821);var e=a.i(95756);let f=(0,c.default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var g=a.i(33508);a.s(["Alert",0,({title:a,children:c,variant:h="info",onClose:i,className:j=""})=>{let k={info:(0,b.jsx)(f,{className:"h-5 w-5 text-blue-400"}),success:(0,b.jsx)(e.CheckCircle,{className:"h-5 w-5 text-green-400"}),warning:(0,b.jsx)(d,{className:"h-5 w-5 text-yellow-400"}),error:(0,b.jsx)(d,{className:"h-5 w-5 text-red-400"})},l=`
    rounded-md p-4
    ${{info:"bg-blue-50 text-blue-800",success:"bg-green-50 text-green-800",warning:"bg-yellow-50 text-yellow-800",error:"bg-red-50 text-red-800"}[h]}
    ${j}
  `;return(0,b.jsx)("div",{className:l,children:(0,b.jsxs)("div",{className:"flex",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:k[h]}),(0,b.jsxs)("div",{className:"ml-3 flex-1",children:[a&&(0,b.jsx)("h3",{className:"text-sm font-medium",children:a}),(0,b.jsx)("div",{className:`text-sm ${a?"mt-2":""}`,children:c})]}),i&&(0,b.jsx)("div",{className:"ml-auto pl-3",children:(0,b.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,b.jsxs)("button",{type:"button",onClick:i,className:`
                  inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2
                  ${"info"===h?"text-blue-500 hover:bg-blue-100 focus:ring-blue-600":""}
                  ${"success"===h?"text-green-500 hover:bg-green-100 focus:ring-green-600":""}
                  ${"warning"===h?"text-yellow-500 hover:bg-yellow-100 focus:ring-yellow-600":""}
                  ${"error"===h?"text-red-500 hover:bg-red-100 focus:ring-red-600":""}
                `,children:[(0,b.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,b.jsx)(g.X,{className:"h-5 w-5"})]})})})]})})}],24452)},18180,a=>{"use strict";var b=a.i(87924);a.s(["Input",0,({label:a,error:c,helperText:d,className:e="",...f})=>{let g=f.id||f.name||Math.random().toString(36).substring(2,9);return(0,b.jsxs)("div",{className:"mb-4",children:[a&&(0,b.jsx)("label",{htmlFor:g,className:"block text-sm font-medium text-gray-700 mb-1",children:a}),(0,b.jsx)("input",{id:g,className:`
          w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 
          focus:outline-none focus:ring-2 
          ${c?"border-error-300 focus:border-error-500 focus:ring-error-500":"border-gray-300 focus:border-secondary-500 focus:ring-secondary-500"}
          ${e}
        `,...f}),c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-error-500",children:c}),d&&!c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:d})]})},"Select",0,({label:a,error:c,helperText:d,options:e,className:f="",...g})=>{let h=g.id||g.name||Math.random().toString(36).substring(2,9);return(0,b.jsxs)("div",{className:"mb-4",children:[a&&(0,b.jsx)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700 mb-1",children:a}),(0,b.jsx)("select",{id:h,className:`
          w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 
          focus:outline-none focus:ring-2 
          ${c?"border-error-300 focus:border-error-500 focus:ring-error-500":"border-gray-300 focus:border-secondary-500 focus:ring-secondary-500"}
          ${f}
        `,...g,children:e.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))}),c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-error-500",children:c}),d&&!c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:d})]})},"Textarea",0,({label:a,error:c,helperText:d,className:e="",...f})=>{let g=f.id||f.name||Math.random().toString(36).substring(2,9);return(0,b.jsxs)("div",{className:"mb-4",children:[a&&(0,b.jsx)("label",{htmlFor:g,className:"block text-sm font-medium text-gray-700 mb-1",children:a}),(0,b.jsx)("textarea",{id:g,className:`
          w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400 
          focus:outline-none focus:ring-2 
          ${c?"border-error-300 focus:border-error-500 focus:ring-error-500":"border-gray-300 focus:border-secondary-500 focus:ring-secondary-500"}
          ${e}
        `,...f}),c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-error-500",children:c}),d&&!c&&(0,b.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:d})]})}])},41710,a=>{"use strict";let b=(0,a.i(70106).default)("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);a.s(["Clock",()=>b],41710)},33354,(a,b,c)=>{"use strict";c._=function(a){return a&&a.__esModule?a:{default:a}}},24987,a=>{"use strict";let b=(0,a.i(70106).default)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);a.s(["MapPin",()=>b],24987)},32245,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"BailoutToCSR",{enumerable:!0,get:function(){return e}});let d=a.r(41997);function e({reason:a,children:b}){throw Object.defineProperty(new d.BailoutToCSRError(a),"__NEXT_ERROR_CODE",{value:"E394",enumerable:!1,configurable:!0})}},7773,(a,b,c)=>{"use strict";function d(a){return a.split("/").map(a=>encodeURIComponent(a)).join("/")}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"encodeURIPath",{enumerable:!0,get:function(){return d}})},97458,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"PreloadChunks",{enumerable:!0,get:function(){return h}});let d=a.r(87924),e=a.r(35112),f=a.r(56704),g=a.r(7773);function h({moduleIds:a}){let b=f.workAsyncStorage.getStore();if(void 0===b)return null;let c=[];if(b.reactLoadableManifest&&a){let d=b.reactLoadableManifest;for(let b of a){if(!d[b])continue;let a=d[b].files;c.push(...a)}}return 0===c.length?null:(0,d.jsx)(d.Fragment,{children:c.map(a=>{let c=`${b.assetPrefix}/_next/${(0,g.encodeURIPath)(a)}`;return a.endsWith(".css")?(0,d.jsx)("link",{precedence:"dynamic",href:c,rel:"stylesheet",as:"style",nonce:b.nonce},a):((0,e.preload)(c,{as:"script",fetchPriority:"low",nonce:b.nonce}),null)})})}},69853,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return j}});let d=a.r(87924),e=a.r(72131),f=a.r(32245),g=a.r(97458);function h(a){return{default:a&&"default"in a?a.default:a}}let i={loader:()=>Promise.resolve(h(()=>null)),loading:null,ssr:!0},j=function(a){let b={...i,...a},c=(0,e.lazy)(()=>b.loader().then(h)),j=b.loading;function k(a){let h=j?(0,d.jsx)(j,{isLoading:!0,pastDelay:!0,error:null}):null,i=!b.ssr||!!b.loading,k=i?e.Suspense:e.Fragment,l=b.ssr?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(g.PreloadChunks,{moduleIds:b.modules}),(0,d.jsx)(c,{...a})]}):(0,d.jsx)(f.BailoutToCSR,{reason:"next/dynamic",children:(0,d.jsx)(c,{...a})});return(0,d.jsx)(k,{...i?{fallback:h}:{},children:l})}return k.displayName="LoadableComponent",k}},19721,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"default",{enumerable:!0,get:function(){return e}});let d=a.r(33354)._(a.r(69853));function e(a,b){let c={};"function"==typeof a&&(c.loader=a);let e={...c,...b};return(0,d.default)({...e,modules:e.loadableGenerated?.modules})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},88736,a=>{"use strict";var b=a.i(87924),c=a.i(33508);a.s(["Modal",0,({isOpen:a,onClose:d,title:e,children:f})=>a?(0,b.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,b.jsxs)("div",{className:"flex min-h-screen items-center justify-center p-4 text-center sm:p-0",children:[(0,b.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:d}),(0,b.jsx)("div",{className:"relative transform overflow-hidden rounded-lg bg-white text-left shadow-xl transition-all sm:my-8 sm:w-full sm:max-w-lg",children:(0,b.jsxs)("div",{className:"bg-white px-4 pb-4 pt-5 sm:p-6 sm:pb-4",children:[(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",id:"modal-title",children:e}),(0,b.jsxs)("button",{type:"button",className:"ml-4 inline-flex flex-shrink-0 items-center justify-center rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",onClick:d,children:[(0,b.jsx)("span",{className:"sr-only",children:"Close"}),(0,b.jsx)(c.X,{className:"h-5 w-5","aria-hidden":"true"})]})]}),(0,b.jsx)("div",{className:"mt-2 text-sm text-gray-500",children:f})]})})]})}):null])},27515,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(38246),e=a.i(19721),f=a.i(24445),g=a.i(24987);let h=(0,a.i(70106).default)("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);var i=a.i(88736),j=a.i(12466),k=a.i(18180),l=a.i(24452),m=a.i(53131),n=a.i(78560),o=a.i(25551),p=a.i(73922);let q=(0,e.default)(async()=>{},{loadableGenerated:{modules:[5481]},ssr:!1,loading:()=>(0,b.jsx)("div",{className:"h-[400px] bg-gray-100 rounded-lg animate-pulse"})});function r(){let{user:a,refreshProfile:e}=(0,m.useAuth)(),{requests:r,myDonations:s,refreshRequests:t,loading:u}=(0,p.useRequests)(),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)("list"),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)({bloodGroup:"all",urgency:"all",location:""});(0,c.useEffect)(()=>{let a=r;if("all"!==B.bloodGroup&&(a=a.filter(a=>a.blood_group===B.bloodGroup)),"all"!==B.urgency&&(a=a.filter(a=>a.urgency_level===B.urgency)),B.location){let b=B.location.toLowerCase();a=a.filter(a=>a.hospital_name.toLowerCase().includes(b)||a.hospital_address.toLowerCase().includes(b))}w(a)},[r,B]);let[D,E]=(0,c.useState)({isOpen:!1,pin:"",hospitalName:""}),[F,G]=(0,c.useState)({isOpen:!1,request:null}),[H,I]=(0,c.useState)({isOpen:!1,request:null}),[J,K]=(0,c.useState)(""),[L,M]=(0,c.useState)(!1),N=async b=>{if(!a)return void A("Please login to donate");if(!(0,o.isBloodCompatible)(a.blood_group,b.blood_group)){b.blood_group,A(`Medical Safety: Your blood group (${a.blood_group}) is not compatible with the patient (${b.blood_group}).`);return}a.donor_pin?G({isOpen:!0,request:b}):I({isOpen:!0,request:b})},O=async()=>{if(a&&4===J.length){M(!0);try{let{error:b}=await n.supabase.from("profiles").update({donor_pin:J}).eq("id",a.id);if(b)throw b;await e(),I({isOpen:!1,request:null}),H.request&&G({isOpen:!0,request:H.request})}catch(a){console.error("Error creating PIN"),A(a.message||"Failed to create PIN")}finally{M(!1)}}},P=async()=>{if(F.request&&a)try{let b=a.donor_pin;if(!b)return void A("Donor PIN not found. Please refresh and try again.");let{error:c}=await n.supabase.from("donations").insert({request_id:F.request.id,donor_id:a.id,status:"pending",otp:b});if(c)throw c;G({isOpen:!1,request:null}),await t(),E({isOpen:!0,pin:b,hospitalName:F.request.hospital_name})}catch(a){console.error("Donation error"),A(a.message||"Failed to process donation request"),G({isOpen:!1,request:null})}};return(0,b.jsxs)("div",{className:"space-y-8",children:[(0,b.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Blood Requests"}),(0,b.jsxs)("div",{className:"flex w-full md:w-auto gap-4",children:[(0,b.jsxs)("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:[(0,b.jsx)("button",{onClick:()=>y("list"),className:`p-2 rounded-md ${"list"===x?"bg-white shadow-sm text-primary-600":"text-gray-500"}`,children:(0,b.jsx)(h,{className:"h-5 w-5"})}),(0,b.jsx)("button",{onClick:()=>y("map"),className:`p-2 rounded-md ${"map"===x?"bg-white shadow-sm text-primary-600":"text-gray-500"}`,children:(0,b.jsx)(g.MapPin,{className:"h-5 w-5"})})]}),a&&(0,b.jsx)(d.default,{href:"/requests/new",className:"flex-1 md:flex-none",children:(0,b.jsx)(j.Button,{variant:"primary",className:"w-full md:w-auto",children:"Create Request"})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,b.jsx)(k.Select,{label:"Blood Group",value:B.bloodGroup,onChange:a=>{C(b=>({...b,bloodGroup:a.target.value}))},options:[{value:"all",label:"All Blood Groups"},{value:"A+",label:"A+"},{value:"A-",label:"A-"},{value:"B+",label:"B+"},{value:"B-",label:"B-"},{value:"AB+",label:"AB+"},{value:"AB-",label:"AB-"},{value:"O+",label:"O+"},{value:"O-",label:"O-"}]}),(0,b.jsx)(k.Select,{label:"Urgency",value:B.urgency,onChange:a=>{C(b=>({...b,urgency:a.target.value}))},options:[{value:"all",label:"All Urgency Levels"},{value:"High",label:"High"},{value:"Medium",label:"Medium"},{value:"Low",label:"Low"}]}),(0,b.jsx)(k.Input,{label:"Location",placeholder:"Enter city or zip code",value:B.location,onChange:a=>C(b=>({...b,location:a.target.value}))})]}),z&&(0,b.jsx)(l.Alert,{variant:"error",onClose:()=>A(""),children:z}),u?(0,b.jsxs)("div",{className:"text-center py-8",children:[(0,b.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto"}),(0,b.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading requests..."})]}):0===v.length?(0,b.jsx)("div",{className:"text-center py-8",children:(0,b.jsx)("p",{className:"text-gray-600",children:"No blood requests found matching your filters"})}):(0,b.jsx)("div",{className:"space-y-4",children:"list"===x?v.map(c=>(0,b.jsx)(f.BloodRequestCard,{request:c,onRespond:a?.id===c.user_id?void 0:()=>N(c),onPendingClick:()=>{a&&a.donor_pin&&E({isOpen:!0,pin:a.donor_pin,hospitalName:c.hospital_name})},userBloodGroup:a?.blood_group,hasOffered:s.has(c.id),isOwnRequest:a?.id===c.user_id},c.id)):(0,b.jsx)("div",{className:"h-[600px] rounded-xl overflow-hidden border border-gray-200",children:(0,b.jsx)(q,{center:{lat:20.5937,lng:78.9629},zoom:5,markers:v.map(a=>({position:{lat:a.location.latitude,lng:a.location.longitude},title:`${a.blood_group} Blood Needed`,description:`${a.hospital_name} - ${a.units_needed} Unit(s)`}))})})}),(0,b.jsx)(i.Modal,{isOpen:H.isOpen,onClose:()=>I({isOpen:!1,request:null}),title:"Create Donor PIN",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("p",{className:"text-gray-600",children:["To ensure security, please create a ",(0,b.jsx)("strong",{children:"4-digit PIN"}),". You will use this PIN for all future donations to verify your identity."]}),(0,b.jsx)("div",{className:"bg-yellow-50 p-3 rounded-md text-yellow-800 text-sm",children:"This PIN is permanent. Please choose one you will remember."}),(0,b.jsx)(k.Input,{label:"Enter 4-digit PIN",placeholder:"e.g. 1234",value:J,onChange:a=>{K(a.target.value.replace(/\D/g,"").slice(0,4))},maxLength:4,className:"text-center text-2xl tracking-widest"}),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(j.Button,{className:"w-full",onClick:O,disabled:4!==J.length||L,isLoading:L,children:"Save PIN & Continue"})})]})}),(0,b.jsx)(i.Modal,{isOpen:F.isOpen,onClose:()=>G({isOpen:!1,request:null}),title:"Confirm Donation Details",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Hospital"}),(0,b.jsx)("p",{className:"font-medium",children:F.request?.hospital_name}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:F.request?.hospital_address})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Blood Group"}),(0,b.jsx)("p",{className:"font-bold text-lg text-primary-600",children:F.request?.blood_group})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Units Needed"}),(0,b.jsxs)("p",{className:"font-medium",children:[F.request?.units_needed," Unit(s)"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Contact Person"}),(0,b.jsx)("p",{className:"font-medium",children:F.request?.contact_name}),(0,b.jsx)("p",{className:"text-sm text-primary-600 font-medium",children:F.request?.contact_phone})]}),F.request?.notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-gray-500",children:"Notes"}),(0,b.jsx)("p",{className:"text-sm italic text-gray-700",children:F.request?.notes})]})]}),(0,b.jsx)("p",{className:"text-sm text-gray-600",children:"By connecting, you agree to visit the hospital and donate blood for this request."}),(0,b.jsxs)("div",{className:"flex gap-3 pt-2",children:[(0,b.jsx)(j.Button,{variant:"secondary",className:"flex-1",onClick:()=>G({isOpen:!1,request:null}),children:"Cancel"}),(0,b.jsx)(j.Button,{className:"flex-1",onClick:P,children:"Confirm & Donate"})]})]})}),(0,b.jsx)(i.Modal,{isOpen:D.isOpen,onClose:()=>E({...D,isOpen:!1}),title:"Donation Initiated",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("p",{children:["Thank you for offering to donate at ",(0,b.jsx)("strong",{children:D.hospitalName}),"!"]}),(0,b.jsxs)("div",{className:"bg-primary-50 p-4 rounded-lg text-center",children:[(0,b.jsx)("p",{className:"text-sm text-primary-700 mb-1",children:"Your Verification PIN"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-primary-600 tracking-wider",children:D.pin})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,b.jsx)("p",{className:"mb-2",children:(0,b.jsx)("strong",{children:"Next Steps:"})}),(0,b.jsxs)("ol",{className:"list-decimal list-inside space-y-1",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Contact the Requestee:"}),' Their phone number will be visible in "My Donations".']}),(0,b.jsx)("li",{children:"Visit the hospital location."}),(0,b.jsxs)("li",{children:["Share this ",(0,b.jsx)("strong",{children:"Donor PIN"})," with them to verify your donation."]})]})]}),(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(j.Button,{className:"w-full",onClick:()=>E({...D,isOpen:!1}),children:"Close"})})]})})]})}a.s(["default",()=>r],27515)}];

//# sourceMappingURL=_2544cc08._.js.map