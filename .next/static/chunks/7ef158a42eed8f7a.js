(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,5050,e=>{"use strict";var s=e.i(43476);e.s(["Card",0,({children:e,className:t=""})=>(0,s.jsx)("div",{className:`bg-white rounded-lg shadow-md overflow-hidden ${t}`,children:e}),"CardBody",0,({children:e,className:t=""})=>(0,s.jsx)("div",{className:`px-6 py-4 ${t}`,children:e}),"CardHeader",0,({children:e,className:t=""})=>(0,s.jsx)("div",{className:`px-6 py-4 border-b border-gray-200 ${t}`,children:e})])},98791,e=>{"use strict";let s=(0,e.i(75254).default)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>s],98791)},78896,e=>{"use strict";var s=e.i(43476),t=e.i(98791),a=e.i(75254);let r=(0,a.default)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),l=(0,a.default)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),i=(0,a.default)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);e.s(["Alert",0,({title:e,children:a,variant:d="info",onClose:n,className:c=""})=>{let x={info:(0,s.jsx)(l,{className:"h-5 w-5 text-blue-400"}),success:(0,s.jsx)(r,{className:"h-5 w-5 text-green-400"}),warning:(0,s.jsx)(t.AlertCircle,{className:"h-5 w-5 text-yellow-400"}),error:(0,s.jsx)(t.AlertCircle,{className:"h-5 w-5 text-red-400"})},o=`
    rounded-md p-4
    ${{info:"bg-blue-50 text-blue-800",success:"bg-green-50 text-green-800",warning:"bg-yellow-50 text-yellow-800",error:"bg-red-50 text-red-800"}[d]}
    ${c}
  `;return(0,s.jsx)("div",{className:o,children:(0,s.jsxs)("div",{className:"flex",children:[(0,s.jsx)("div",{className:"flex-shrink-0",children:x[d]}),(0,s.jsxs)("div",{className:"ml-3 flex-1",children:[e&&(0,s.jsx)("h3",{className:"text-sm font-medium",children:e}),(0,s.jsx)("div",{className:`text-sm ${e?"mt-2":""}`,children:a})]}),n&&(0,s.jsx)("div",{className:"ml-auto pl-3",children:(0,s.jsx)("div",{className:"-mx-1.5 -my-1.5",children:(0,s.jsxs)("button",{type:"button",onClick:n,className:`
                  inline-flex rounded-md p-1.5 focus:outline-none focus:ring-2 focus:ring-offset-2
                  ${"info"===d?"text-blue-500 hover:bg-blue-100 focus:ring-blue-600":""}
                  ${"success"===d?"text-green-500 hover:bg-green-100 focus:ring-green-600":""}
                  ${"warning"===d?"text-yellow-500 hover:bg-yellow-100 focus:ring-yellow-600":""}
                  ${"error"===d?"text-red-500 hover:bg-red-100 focus:ring-red-600":""}
                `,children:[(0,s.jsx)("span",{className:"sr-only",children:"Dismiss"}),(0,s.jsx)(i,{className:"h-5 w-5"})]})})})]})})}],78896)},61911,e=>{"use strict";let s=(0,e.i(75254).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);e.s(["Users",()=>s],61911)},21218,e=>{"use strict";let s=(0,e.i(75254).default)("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);e.s(["Activity",()=>s],21218)},23261,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(17927),r=e.i(5050),l=e.i(76525),i=e.i(78896),d=e.i(29377),n=e.i(75254);let c=(0,n.default)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var x=e.i(61911),o=e.i(21218);let m=(0,n.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),h=(0,n.default)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),u=(0,n.default)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);var p=e.i(61574),g=e.i(84614),y=e.i(46932);function f(){let[e,n]=(0,t.useState)("overview"),[f,j]=(0,t.useState)({users:0,donors:0,pending:0,requests:0}),[v,b]=(0,t.useState)([]),[N,w]=(0,t.useState)([]),[k,_]=(0,t.useState)(!0),[C,q]=(0,t.useState)(null),[A,S]=(0,t.useState)(""),[M,$]=(0,t.useState)("");(0,t.useEffect)(()=>{B()},[]);let B=async()=>{_(!0);try{let[e,s]=await Promise.all([a.supabase.from("profiles").select("*").order("created_at",{ascending:!1}),a.supabase.from("blood_requests").select("*").order("created_at",{ascending:!1})]);if(e.error)throw e.error;if(s.error)throw s.error;let t=e.data||[],r=s.data||[];b(t),w(r),j({users:t.length,donors:t.filter(e=>e.is_donor).length,pending:t.filter(e=>"pending"===e.verification_status&&e.is_donor).length,requests:r.filter(e=>"active"===e.status).length})}catch(e){S(e.message)}finally{_(!1)}},L=async(e,s)=>{q(e);try{let{error:t}=await a.supabase.from("profiles").update({verification_status:s}).eq("id",e);if(t)throw t;b(t=>t.map(t=>t.id===e?{...t,verification_status:s}:t)),j(e=>({...e,pending:e.pending-1}))}catch(e){S(e.message)}finally{q(null)}},z=async(e,s)=>{if(!confirm("Are you sure you want to change this user's role?"))return;q(e);let t="admin"===s?"user":"admin";try{let{error:s}=await a.supabase.from("profiles").update({role:t}).eq("id",e);if(s)throw s;b(s=>s.map(s=>s.id===e?{...s,role:t}:s))}catch(e){S(e.message)}finally{q(null)}},U=async e=>{if(confirm("Delete this request permanently?")){q(e);try{let{error:s}=await a.supabase.from("blood_requests").delete().eq("id",e);if(s)throw s;w(s=>s.filter(s=>s.id!==e))}catch(e){S(e.message)}finally{q(null)}}},D=v.filter(e=>e.full_name?.toLowerCase().includes(M.toLowerCase())||e.email?.toLowerCase().includes(M.toLowerCase())),P=v.filter(e=>"pending"===e.verification_status&&e.is_donor);return k?(0,s.jsx)("div",{className:"flex justify-center p-8",children:(0,s.jsx)(d.Loader2,{className:"animate-spin h-8 w-8 text-red-500"})}):(0,s.jsxs)("div",{className:"space-y-8",children:[A&&(0,s.jsx)(i.Alert,{variant:"error",onClose:()=>S(""),children:A}),(0,s.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,s.jsx)(r.Card,{className:"bg-blue-50 border-blue-100",children:(0,s.jsxs)(r.CardBody,{className:"p-4 flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 bg-blue-100 rounded-full text-blue-600",children:(0,s.jsx)(x.Users,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.users}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Total Users"})]})]})}),(0,s.jsx)(r.Card,{className:"bg-red-50 border-red-100",children:(0,s.jsxs)(r.CardBody,{className:"p-4 flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 bg-red-100 rounded-full text-red-600",children:(0,s.jsx)(p.HeartPulse,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.donors}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Donors"})]})]})}),(0,s.jsx)(r.Card,{className:"bg-orange-50 border-orange-100",children:(0,s.jsxs)(r.CardBody,{className:"p-4 flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 bg-orange-100 rounded-full text-orange-600",children:(0,s.jsx)(m,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.pending}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Pending Verify"})]})]})}),(0,s.jsx)(r.Card,{className:"bg-green-50 border-green-100",children:(0,s.jsxs)(r.CardBody,{className:"p-4 flex items-center space-x-4",children:[(0,s.jsx)("div",{className:"p-3 bg-green-100 rounded-full text-green-600",children:(0,s.jsx)(o.Activity,{size:24})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"text-2xl font-bold",children:f.requests}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:"Active Requests"})]})]})})]}),(0,s.jsx)("div",{className:"flex space-x-1 border-b overflow-x-auto pb-1",children:["overview","users","verifications","requests"].map(t=>(0,s.jsxs)("button",{onClick:()=>n(t),className:`px-4 py-2 capitalize font-medium text-sm transition-colors relative ${e===t?"text-red-600":"text-gray-500 hover:text-gray-700"}`,children:[t,e===t&&(0,s.jsx)(y.motion.div,{layoutId:"underline",className:"absolute left-0 right-0 bottom-[-5px] h-0.5 bg-red-600"})]},t))}),(0,s.jsxs)("div",{className:"min-h-[400px]",children:["overview"===e&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:"Activity Stream"}),(0,s.jsxs)("div",{className:"space-y-4",children:[[...v,...N].sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime()).slice(0,10).map((e,t)=>{let a="full_name"in e;return(0,s.jsxs)("div",{className:"flex items-start space-x-3 p-3 bg-white rounded-lg border border-gray-100 hover:shadow-sm transition-shadow",children:[(0,s.jsx)("div",{className:`p-2 rounded-full ${a?"bg-blue-100 text-blue-600":"bg-red-100 text-red-600"}`,children:a?(0,s.jsx)(g.User,{size:16}):(0,s.jsx)(o.Activity,{size:16})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-900",children:a?(0,s.jsxs)("span",{children:["New user ",(0,s.jsx)("span",{className:"font-semibold",children:e.full_name})," joined the platform."]}):(0,s.jsxs)("span",{children:["New blood request for ",(0,s.jsx)("span",{className:"font-semibold",children:e.blood_group})," at ",e.hospital_name,"."]})}),(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:new Date(e.created_at).toLocaleString()})]})]},t)}),0===v.length&&0===N.length&&(0,s.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No activity recorded yet."})]})]}),"users"===e&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-2 bg-white border border-gray-300 rounded-md px-3 py-2 w-full max-w-sm",children:[(0,s.jsx)(h,{className:"h-4 w-4 text-gray-400"}),(0,s.jsx)("input",{type:"text",placeholder:"Search users by name or email...",className:"outline-none text-sm w-full",value:M,onChange:e=>$(e.target.value)})]}),(0,s.jsx)("div",{className:"overflow-x-auto border rounded-lg",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.full_name||"Unknown"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:e.email})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"admin"===e.role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"}`,children:e.role||"user"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:e.is_donor?(0,s.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"verified"===e.verification_status?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:"verified"===e.verification_status?"Verified Donor":"Pending Verified"}):(0,s.jsx)("span",{className:"text-gray-400 text-xs",children:"Recipient"})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsx)(l.Button,{size:"sm",variant:"ghost",className:"text-blue-600 hover:text-blue-900",isLoading:C===e.id,onClick:()=>z(e.id,e.role||"user"),children:"admin"===e.role?"Demote to User":"Promote to Admin"})})]},e.id))})]})})]}),"verifications"===e&&(0,s.jsx)("div",{className:"space-y-4",children:0===P.length?(0,s.jsx)("div",{className:"text-center py-10 text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-300",children:"No pending verifications. All caught up!"}):P.map(e=>(0,s.jsx)(r.Card,{children:(0,s.jsxs)(r.CardBody,{className:"flex flex-col md:flex-row justify-between items-center gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-bold",children:e.full_name}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Blood Group: ",(0,s.jsx)("span",{className:"font-bold text-red-600",children:e.blood_group})]})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[e.blood_group_proof_url&&(0,s.jsxs)("a",{href:(e=>{if(!e)return"";let{data:s}=a.supabase.storage.from("proofs").getPublicUrl(e);return s.publicUrl})(e.blood_group_proof_url),target:"_blank",className:"flex items-center text-blue-600 text-sm hover:underline px-3",children:["View Proof ",(0,s.jsx)(c,{className:"ml-1 w-3 h-3"})]}),(0,s.jsx)(l.Button,{variant:"secondary",size:"sm",onClick:()=>L(e.id,"rejected"),isLoading:C===e.id,children:"Reject"}),(0,s.jsx)(l.Button,{variant:"success",size:"sm",onClick:()=>L(e.id,"verified"),isLoading:C===e.id,children:"Approve"})]})]})},e.id))}),"requests"===e&&(0,s.jsx)("div",{className:"overflow-x-auto border rounded-lg",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Hospital"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Blood Group"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),(0,s.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Action"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:N.map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-6 py-4 text-sm font-medium text-gray-900",children:e.hospital_name}),(0,s.jsxs)("td",{className:"px-6 py-4 text-sm text-gray-900",children:[e.blood_group," (",e.units_needed," units) ",(0,s.jsx)("span",{className:"text-xs text-red-500 border border-red-200 px-1 rounded",children:e.urgency_level})]}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,s.jsx)("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${"active"===e.status?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:e.status})}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm text-gray-500",children:new Date(e.created_at).toLocaleDateString()}),(0,s.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,s.jsx)("button",{onClick:()=>U(e.id),className:"text-red-500 hover:text-red-700",children:(0,s.jsx)(u,{className:"w-4 h-4"})})})]},e.id))})]})})]})]})}e.s(["default",()=>f],23261)}]);